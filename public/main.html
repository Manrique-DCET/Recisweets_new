<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReciSweets</title>
    <link rel="icon" href="favicon.ico">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <header>
            <div class="logo">
                <h1>ReciSweets</h1>
            </div>
            <nav>
                <ul>
                    <li><button id="togglePublicBtn" class="delete-bttn" style="background-color: #28a745;">Show Public
                            Recipes</button></li>
                </ul>
            </nav>
        </header>

        <button class="add-btn" id="addRecipeBtn">+ Add Recipe</button>

        <main>
            <div class="recipe-list">
                <div class="view">
                    <img src="cat-wtf.gif" width="100">
                    <h2 id="galleryTitle">My Recipe Gallery</h2>
                    <img src="cat-wtf.gif" width="100">
                    <div style="display: flex;"><input class="search" id="itemSearch" type="text"
                            placeholder="Search Recipe">
                        <button class="btn" onclick="searchRecipe()">Search</button>
                    </div>
                    <button id="sortBtn" class="sort-btn">Sort</button>
                </div>
                <table id="recipeTable1">
                    <thead>
                        <tr>
                            <th style="width: 15%;">Type of Sweet</th>
                            <th style="width: 20%;">Image</th>
                            <th style="width: 10%;">Date Added</th>
                            <th>Recipe Name</th>
                            <th style="width: 10%;">Difficulty</th>
                        </tr>
                    </thead>
                    <tbody id="recipeBody">
                    </tbody>
                </table>
            </div>
        </main>

        <!-- modal for adding recipes -->
        <div id="addRecipeModal" class="modal">
            <div class="modal-content">
                <span class="close" id="closeAddRecipeModal">&times;</span>
                <h3>Add Recipe</h3>
                <form id="addRecipeForm">
                    <div class="form-group">
                        <label for="recipeImage">Recipe Image:</label>
                        <input type="file" id="recipeImage" name="recipeImage" required>
                    </div>
                    <div class="form-group">
                        <label for="recipeName">Recipe Name:</label>
                        <input type="text" id="recipeName" name="recipeName" required>
                    </div>
                    <div class="form-group">
                        <label for="difficulty">Difficulty:</label>
                        <select id="difficulty" name="difficulty" required>
                            <option value="easy">Easy</option>
                            <option value="medium">Medium</option>
                            <option value="hard">Hard</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="type">Type of Sweet:</label>
                        <select id="type" name="type" required>
                            <option value="Cakes">Cakes</option>
                            <option value="Cookies">Cookies</option>
                            <option value="Biscuits">Biscuits</option>
                            <option value="Pastries">Pastries</option>
                            <option value="Custards and Puddings">Custards and Puddings</option>
                            <option value="Deep Fried Sweets">Deep Fried Sweets</option>
                            <option value="Frozen Sweets">Frozen Sweets</option>
                            <option value="Gelatin Desserts">Gelatin Desserts</option>
                            <option value="Fruit Desserts">Fruit Desserts</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="ingredients">Ingredients:</label>
                        <div>
                            <textarea id="ingredients" name="ingredients" rows="3"
                                placeholder="Type the ingredients here" required></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="recipeInst">Instructions:</label>
                        <div>
                            <textarea id="recipeInst" name="recipeInst" rows="3"
                                placeholder="Type the instructions here" required></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="PCtime">Total Time:</label>
                        <input type="text" id="PCtime" name="PCtime" placeholder="e.g. 30 minutes" required>
                    </div>
                    <div class="form-group">
                        <label for="servings">Servings:</label>
                        <input type="number" id="servings" name="servings" min="1" placeholder="e.g. 4 servings"
                            required>
                    </div>
                    <div class="form-group">
                        <label for="info">Nutritional Information: (optional)</label>
                        <div><textarea id="info" name="info" rows="3"
                                placeholder="Type the nutritional information here"></textarea></div>
                    </div>
                    <div class="form-group">
                        <label for="equipment">Equipment Needed: (optional)</label>
                        <div><textarea id="equipment" name="equipment" rows="3"
                                placeholder="Type the equipment needed here"></textarea></div>
                    </div>
                    <div class="form-group">
                        <label for="tips">Tips and Tricks: (optional)</label>
                        <div><textarea id="tips" name="tips" rows="3" placeholder="Provide some tips here"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="storage">Storage Instructions: (optional)</label>
                        <div><textarea id="storage" name="storage" rows="3"
                                placeholder="How to store leftovers or how long the dish last"></textarea></div>
                    </div>
                    <div class="form-group">
                        <label for="isPublic">
                            <input type="checkbox" id="isPublic" name="isPublic">
                            Make Recipe Public (others can view and save this recipe)
                        </label>
                    </div>
                    <button type="submit" class="add-recipe-btn" id="addRecipe">Add Recipe</button>
                    <button type="button" class="cancel-btn" id="cancelAddRecipeBtn">Cancel</button>
                </form>
            </div>
        </div>

        <!-- modal for sorting recipes  -->
        <div id="sortItems" class="sort-modal">
            <div class="sort-modal-content">
                <span class="close-sorting" id="closeSortModal">&times;</span>
                <h3>Sort Recipes</h3>
                <form id="sortItemForm">
                    <div class="form-group">
                        <select id="sortByName">
                            <option value="name">Recipe Name (A-Z)</option>
                            <option value="name_desc">Recipe Name (Z-A)</option>
                        </select>
                        <select id="sortByDate">
                            <option value="date_asc">Date Added (Oldest)</option>
                            <option value="date_desc">Date Added (Newest)</option>
                        </select>
                    </div>
                    <h3>Type of Sweets:</h3>
                    <div class="form-group">
                        <span class="thumb">
                            <label for="cake"><img src="easy_chocolate_cake_slice-500x500.jpg" height="100"
                                    width="100"></label>
                            <input type="checkbox" id="cake" name="sortOrder" value="cakes">
                            <label for="cake">Cakes</label>
                        </span>

                        <span class="thumb">
                            <label for="cookies"><img src="chocolate-chip-cookie.jpg" height="100" width="100"></label>
                            <input type="checkbox" id="cookies" name="sortOrder" value="cookies">
                            <label for="cookies">Cookies</label>
                        </span>

                        <span class="thumb">
                            <label for="biscuits"><img src="recipe-image-legacy-id-901527_10-cb91efc.jpg" height="100"
                                    width="100"></label>
                            <input type="checkbox" id="biscuits" name="sortOrder" value="biscuits">
                            <label for="biscuits">Biscuits</label>
                        </span>

                        <span class="thumb">
                            <label for="pastries"><img src="Pastry_baking-processes-e1593464950587.jpg" height="100"
                                    width="100"></label>
                            <input type="checkbox" id="pastries" name="sortOrder" value="pastries">
                            <label for="pastries">Pastries</label>
                        </span>

                        <span class="thumb">
                            <label for="puddings"><img src="istockphoto-139483187-612x612.jpg" height="100"
                                    width="100"></label>
                            <input type="checkbox" id="puddings" name="sortOrder" value="custardsandpuddings">
                            <label for="puddings">Custards and Puddings</label>
                        </span>

                        <span class="thumb">
                            <label for="deepfried"><img
                                    src="54f6527f61350_-_orange-kissed-churros-with-hot-chocolate-sauce-recipe-mdn.jpg"
                                    height="100" width="100"></label>
                            <input type="checkbox" id="deepfried" name="sortOrder" value="deepfriedsweets">
                            <label for="deepfried">Deep Fried Sweets</label>
                        </span>

                        <span class="thumb">
                            <label for="frozen"><img src="exps183409_RDS143481C04_16_6b.jpg" height="100"
                                    width="100"></label>
                            <input type="checkbox" id="frozen" name="sortOrder" value="frozensweets">
                            <label for="frozen">Frozen Sweets</label>
                        </span>

                        <span class="thumb">
                            <label for="gelatin"><img src="jello-mc-1x1-241121.jpg" height="100" width="100"></label>
                            <input type="checkbox" id="gelatin" name="sortOrder" value="gelatin">
                            <label for="gelatin">Gelatin Desserts</label>
                        </span>

                        <span class="thumb">
                            <label for="fruit"><img
                                    src="fourth-trimester-mixed-fruit-salad_LEDE_V2_061124_1745_VOG_final.jpg"
                                    height="100" width="100"></label>
                            <input type="checkbox" id="fruit" name="sortOrder" value="fruitdesserts">
                            <label for="fruit">Fruit Desserts</label>
                        </span>
                    </div>
                    <button type="button" class="applysort" id="applySortBtn">Apply Sort</button>
                    <button type="button" class="resetsort" id="resetSorting">Reset Sort</button>
                </form>
            </div>
        </div>

    </div>

    <!-- modal to show recipe's full details -->
    <div id="recipeDetailsModal" class="recipe-modal">
        <div class="detail-modal-content">
            <span class="close" id="closeDetailsModal">&times;</span>
            <div class="detail-bg" id="detailBackgroundImage"></div>
            <div class="detail-info">
                <h2 id="detailTitle"></h2>

                <p><strong>Difficulty:</strong> <span id="detailDifficulty"></span></p>
                <p><strong>Type:</strong> <span id="detailType"></span></p>
                <p><strong>Total Time:</strong> <span id="detailTime"></span></p>
                <p><strong>Servings:</strong> <span id="detailServings"></span></p>
                <p><strong>Ingredients:</strong>
                <pre id="detailIngredients"></pre>
                </p>
                <p><strong>Instructions:</strong>
                <pre id="detailInstructions"></pre>
                </p>
                <p><strong>Nutrition Info:</strong>
                <pre id="detailInfo"></pre>
                </p>
                <p><strong>Equipment:</strong>
                <pre id="detailEquipment"></pre>
                </p>
                <p><strong>Tips:</strong>
                <pre id="detailTips"></pre>
                </p>
                <p><strong>Storage:</strong>
                <pre id="detailStorage"></pre>
                </p>
                <p><strong>Date Added:</strong> <span id="detailDate"></span></p>

                <div class="detail-actions">
                    <button id="editRecipeBtn" class="edit-bttn">Edit</button>
                    <button id="deleteRecipeBtn" class="delete-bttn">Delete</button>
                    <button id="shareRecipeBtn" class="edit-bttn">Share</button>
                    <button id="downloadRecipePngBtn" class="edit-bttn">Download as PDF</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let showingPublicRecipes = false;

        document.addEventListener('DOMContentLoaded', function () {
            const toggleBtn = document.getElementById('togglePublicBtn');
            const galleryTitle = document.getElementById('galleryTitle');

            if (toggleBtn && galleryTitle) {
                toggleBtn.addEventListener('click', async function () {
                    showingPublicRecipes = !showingPublicRecipes;

                    if (showingPublicRecipes) {
                        toggleBtn.textContent = 'Show My Recipes';
                        toggleBtn.style.backgroundColor = '#007bff';
                        galleryTitle.textContent = 'All Public Recipes';

                        // Load and display public recipes
                        try {
                            await loadPublicRecipes();
                        } catch (error) {
                            console.error('Error loading public recipes:', error);
                            alert('Failed to load public recipes');
                            // Revert the toggle state
                            showingPublicRecipes = false;
                            toggleBtn.textContent = 'Show Public Recipes';
                            toggleBtn.style.backgroundColor = '#28a745';
                            galleryTitle.textContent = 'My Recipe Gallery';
                        }
                    } else {
                        toggleBtn.textContent = 'Show Public Recipes';
                        toggleBtn.style.backgroundColor = '#28a745';
                        galleryTitle.textContent = 'My Recipe Gallery';

                        // Display user's own recipes
                        displayRecipes();
                    }
                });
            }
        });
    </script>

    <script src="script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</body>

</html>